source qemudbg_init.in
set logging on
set strcpy(env_var[0].name, "EDITOR")
set strcpy(env_var[0].value, "gedit")
set strcpy(env_var[1].name, "PATH")
set strcpy(env_var[1].value, "~")
set strcpy(env_var[2].name, "LC_ALL")
set strcpy(env_var[2].value, "UTF8")
set env_count=3
set strcpy(cmd[0], "export")
set strcpy(cmd[1], "EDITOR=vi")
show_environment_variables
echo Processed argv list:\n
set $r0=0
set $sp=$sp-2*sizeof(char*)
while $r0<2
   x/s cmd[$r0]
   set ((char**)$sp)[$r0]=cmd[$r0]
   set $r0++
end
call export_envvar(2, (char**)$sp)
if env_var[0].value[0]=='v' && env_var[0].value[1]=='i' && env_var[0].value[2]=='\0'
   echo Pass: exported value is correct\n
else
   echo Fail: exportation failure\n
   x/s env_var[1].value
end
if env_count==3
   echo Pass: correct value of env_count\n
else
   echo Fail: wrong value of env_count\n
   p env_count
end

